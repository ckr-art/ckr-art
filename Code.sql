SELECT * FROM ecommerce.customer_order;

CREATE TABLE CustomerOrders (
    CustomerID VARCHAR(20),
    OrderID VARCHAR(20),
    ProductName VARCHAR(50),
    OrderDate DATE,
    Category VARCHAR(50),
    Quantity INT,
    Price DECIMAL(10, 2),
    Discount DECIMAL(5, 2),
    Sales DECIMAL(10, 2),
    Profit DECIMAL(10, 2),
    Region VARCHAR(20)
);

 
INSERT INTO CustomerOrders (CustomerID, OrderID, ProductName, OrderDate, Category, Quantity, Price, Discount, Sales, Profit, Region)
VALUES
('CLIST-0001', 'ORD-000001', 'Groceries', '2020-11-23', 'Groceries', 9, 120.16, 0.04, 91.30, 0.09, 'East'),
('CLIST-0002', 'ORD-000002', 'Chair', '2020-02-27', 'Furniture', 16, 247.45, 0.21, 2195.88, 429.13, 'East'),
('CUST-0002', 'ORD-000003', 'Rice', '2020-01-13', 'Groceries', 13, 44.42, 0.01, 291.41, 72.90, 'East'),
('CUST-0004', 'ORD-000004', 'Textbook', '2020-05-20', 'Books', 7, 54.75, 0.29, 38.87, 5.77, 'West'),
('CUST-0005', 'ORD-000005', 'Jacket', '2020-05-05', 'Clothing', 2, 240.55, 0.20, 115.46, 46.00, 'East'),
('CUST-0057', 'ORD-000007', 'Wardrobe', '2020-03-12', 'Furniture', 14, 404.34, 0.14, 3135.70,'West')

SELECT REGION,
SUM(SALES) AS TOTAL_SALE,
SUM(PROFIT) AS TOTAL_PROFIT
FROM CUSTOMER_ORDER
GROUP BY REGION
ORDER BY TOTAL_SALE DESC;


SELECT PRODUCT_NAME,
SUM(PROFIT) AS TOTAL_PROFIT
FROM CUSTOMER_ORDER
GROUP BY PRODUCT_NAME
ORDER BY TOTAL_PROFIT DESC
LIMIT 5;

SELECT SUM(SALES) AS TOTAL_SALE,
DATE_FORMAT(ORDER_DATE, '%Y-%M') AS ORDER_MONTH
FROM CUSTOMER_ORDER
GROUP BY ORDER_MONTH
ORDER BY ORDER_MONTH;

SELECT DISCOUNT,
AVG(PROFIT) AS AVERAGE_PROFIT,
COUNT(*) AS ORDERS
FROM CUSTOMER_ORDER
GROUP BY DISCOUNT
ORDER BY AVERAGE_PROFIT DESC;


SELECT CUSTOMER_ID,SUM(SALES) AS TOTAL_SPEND
FROM CUSTOMER_ORDER
GROUP BY CUSTOMER_ID
ORDER BY TOTAL_SPEND
LIMIT 10;


SELECT CATEGORY,SUM(SALES) AS TOTAL_SALE,
RANK() OVER (ORDER BY SUM(SALES) DESC) AS RANKED
FROM CUSTOMER_ORDER
GROUP BY CATEGORY
ORDER BY RANKED;